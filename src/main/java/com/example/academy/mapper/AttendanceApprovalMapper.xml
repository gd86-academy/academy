<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.academy.mapper.AttendanceApprovalMapper">
	
	<!-- 김혜린 : 근태신청서 신청 -->
	<insert id="insertAttendanceApproval" parameterType="com.example.academy.dto.AttendanceApprovalAddDTO" useGeneratedKeys="true" keyProperty="attendanceApprovalNo">
		INSERT INTO attendance_approval(
			employee_no
			, attendance_approval_title
			, attendance_approval_content
			, attendance_approval_begindate
			, attendance_approval_enddate
			, attendance_approval_type
			)
		VALUES (
			#{employeeNo}
			, #{attendanceApprovalTitle}
			, #{attendanceApprovalContent}
			, #{attendanceApprovalBeginDate}
			, #{attendanceApprovalEndDate}
			, #{attendanceApprovalType}
			)
	</insert>
	
	<!-- 김혜린 : 근태신청서리스트 조회 -->
	<select id="selectAttendanceAprrovalList" parameterType="Integer" resultType="com.example.academy.dto.AttendanceApprovalListDTO">
		SELECT 
			aa.attendance_approval_no attendanceApprovalNo
			, aa.attendance_approval_title attendanceApprovalTitle
			, aa.attendance_approval_type attendanceApprovalTypeCode
			, c1.`name` attendanceApprovalType
			, aa.employee_no employeeNo
			, e.employee_name employeeName
			, aa.attendance_approval_status attendanceApprovalStatusCode
			, c2.`name` attendanceApprovalStatus
		FROM attendance_approval aa LEFT OUTER JOIN employee e
		ON aa.employee_no = e.employee_no 
		LEFT OUTER JOIN common c1
		ON aa.attendance_approval_type = c1.code
		LEFT OUTER JOIN common c2
		ON aa.attendance_approval_status = c2.code
		WHERE aa.use_yn = 1
		AND aa.employee_no = #{employeeNo}
	</select>
	
</mapper>